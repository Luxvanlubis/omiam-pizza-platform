const { createClient } = require('@supabase/supabase-js');

// Configuration Supabase
const supabaseUrl = 'https://bnjmxkjpngvkmelhknjv.supabase.co';
const supabaseService = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJuam14a2pwbmd2a21lbGhrbmp2Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NTgwMzUxNiwiZXhwIjoyMDcxMzc5NTE2fQ.F5d5kZ3Q81tQeFfoFCKHGqHUEQ196xgXblR8ZxV8dnU';

// Créer le client Supabase avec la clé de service
const supabase = createClient(supabaseUrl, supabaseService);

async function setupCMS() { try { console.log('🚀 Configuration du CMS OMIAM...'); // Données de  pour le CMS const Data = [ { : 'hero.title', title: 'Titre Principal', content: 'Bienvenue chez OMIAM - Saveurs Authentiques du Maroc', type: 'title', page: 'home', section: 'hero', is_published: true, metadata: { priority: 'high', featured: true } }, { : 'hero.description', title: 'Description Hero', content: 'Découvrez nos plats traditionnels marocains préparés avec amour et des ingrédients frais.', type: 'description', page: 'home', section: 'hero', is_published: true, metadata: { style: 'large' } }, { : 'hero.cta', title: 'Bouton CTA', content: 'Commander maintenant', type: 'button', page: 'home', section: 'hero', is_published: true, metadata: { variant: 'primary', size: 'large' } }, { : 'about.title', title: 'Titre À propos', content: 'Notre Histoire', type: 'title', page: 'about', section: 'main', is_published: true, metadata: { level: 'h2' } }, { : 'about.content', title: 'Contenu À propos', content: 'OMIAM est né de la passion pour la cuisine marocaine authentique. Depuis 2020, nous servons des plats traditionnels dans une ambiance chaleureuse.', type: 'text', page: 'about', section: 'main', is_published: true, metadata: { format: 'paragraph' } }, { : 'contact.phone', title: 'Téléphone', content: '+33 1 23 45 67 89', type: 'text', page: 'contact', section: 'info', is_published: true, metadata: { format: 'phone', icon: 'phone' } }, { : 'contact.email', title: 'Email', content: 'contact@omiam.fr', type: 'text', page: 'contact', section: 'info', is_published: true, metadata: { format: 'email', icon: 'mail' } }, { : 'contact.address', title: 'Adresse', content: '123 Rue de la Paix, 75001 Paris', type: 'text', page: 'contact', section: 'info', is_published: true, metadata: { format: 'address', icon: 'map-pin' } }, { : 'menu.featured.title', title: 'Nos Spécialités', content: 'Découvrez nos plats signature', type: 'title', page: 'menu', section: 'featured', is_published: true, metadata: { level: 'h2', style: 'featured' } }, { : 'footer.copyright', title: 'Copyright', content: '© 2024 OMIAM. Tous droits réservés.', type: 'text', page: 'global', section: 'footer', is_published: true, metadata: { position: 'bottom' } } ]; console.log('📝 Tentative d\'insertion des données CMS...'); // Essayer d'insérer les données (la table doit exister) let successCount = 0; let errorCount = 0; for (const item of Data) { try { const { data, error } = await supabase .from('content_items') .upsert(item, { onConflict: , ignoreDuplicates: false }) .select(); if (error) { console.log(`⚠️ Erreur pour ${item.}:`, error.message); errorCount++; } else { console.log(`✅ Données CMS: ${item.}`); successCount++; } } catch (err) { console.log(`⚠️ Exception pour ${item.}:`, err.message); errorCount++; } } console.log(`\n📊 Résumé:`); console.log(`✅ Succès: ${successCount}`); console.log(`⚠️ Erreurs: ${errorCount}`); if (successCount > 0) { // Vérifier les données insérées console.log('\n🔍 Vérification des données CMS...'); const { data: items, error: selectError } = await supabase .from('content_items') .select(, title, type, page, is_published') .order('created_at', { ascending: true }); if (selectError) { console.error('❌ Erreur lors de la vérification:', selectError.message); } else { console.log(`\n✅ ${items.length} éléments de contenu dans la base:`); // Grouper par page const itemsByPage = items.reduce((acc, item) => { if (!acc[item.page]) acc[item.page] = []; acc[item.page].push(item); return acc; }, {}); Object.entries(itemsByPage).forEach(([page, pageItems]) => { console.log(`\n  📄 Page "${page}":`); pageItems.forEach(item => { const status = item.is_published ? '🟢' : '🔴'; console.log(` ${status} ${item.} (${item.type}) - ${item.title}`); }); }); } console.log('\n🎉 Configuration CMS terminée avec succès!'); console.log('\n💡 Prochaines étapes:'); console.log(' 1. Vérifier l\'interface  CMS'); console.log(' 2. er la modification de contenu'); console.log(' 3. Vérifier l\'affichage sur le site'); } else { console.log('\n❌ Aucune donnée n\'a pu être insérée.'); console.log('\n🔧 Actions requises:'); console.log(' 1. Vérifier que la table content_items existe'); console.log(' 2. Exécuter le script SQL: scripts/create-cms-table.sql'); console.log(' 3. Vérifier les permissions Supabase'); } } catch (error) { console.error('❌ Erreur générale:', error.message); console.log('\n🔧 Vérifications suggérées:'); console.log(' 1. Connexion Supabase'); console.log(' 2. Clés d\'API valides'); console.log(' 3. Table content_items créée'); }
}

// Exécuter la configuration
if (require.main === module) { setupCMS();
}

module.exports = { setupCMS };