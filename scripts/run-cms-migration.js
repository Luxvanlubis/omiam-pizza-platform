const { createClient } = require('@supabase/supabase-js');

// Configuration Supabase
const supabaseUrl = 'https://bnjmxkjpngvkmelhknjv.supabase.co';
const supabaseService = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJuam14a2pwbmd2a21lbGhrbmp2Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NTgwMzUxNiwiZXhwIjoyMDcxMzc5NTE2fQ.F5d5kZ3Q81tQeFfoFCKHGqHUEQ196xgXblR8ZxV8dnU';

// CrÃ©er le client Supabase avec la clÃ© de service
const supabase = createClient(supabaseUrl, supabaseService);

async function setupCMS() { try { console.log('ğŸš€ Configuration du CMS OMIAM...'); // DonnÃ©es de  pour le CMS const Data = [ { : 'hero.title', title: 'Titre Principal', content: 'Bienvenue chez OMIAM - Saveurs Authentiques du Maroc', type: 'title', page: 'home', section: 'hero', is_published: true, metadata: { priority: 'high', featured: true } }, { : 'hero.description', title: 'Description Hero', content: 'DÃ©couvrez nos plats traditionnels marocains prÃ©parÃ©s avec amour et des ingrÃ©dients frais.', type: 'description', page: 'home', section: 'hero', is_published: true, metadata: { style: 'large' } }, { : 'hero.cta', title: 'Bouton CTA', content: 'Commander maintenant', type: 'button', page: 'home', section: 'hero', is_published: true, metadata: { variant: 'primary', size: 'large' } }, { : 'about.title', title: 'Titre Ã€ propos', content: 'Notre Histoire', type: 'title', page: 'about', section: 'main', is_published: true, metadata: { level: 'h2' } }, { : 'about.content', title: 'Contenu Ã€ propos', content: 'OMIAM est nÃ© de la passion pour la cuisine marocaine authentique. Depuis 2020, nous servons des plats traditionnels dans une ambiance chaleureuse.', type: 'text', page: 'about', section: 'main', is_published: true, metadata: { format: 'paragraph' } }, { : 'contact.phone', title: 'TÃ©lÃ©phone', content: '+33 1 23 45 67 89', type: 'text', page: 'contact', section: 'info', is_published: true, metadata: { format: 'phone', icon: 'phone' } }, { : 'contact.email', title: 'Email', content: 'contact@omiam.fr', type: 'text', page: 'contact', section: 'info', is_published: true, metadata: { format: 'email', icon: 'mail' } }, { : 'contact.address', title: 'Adresse', content: '123 Rue de la Paix, 75001 Paris', type: 'text', page: 'contact', section: 'info', is_published: true, metadata: { format: 'address', icon: 'map-pin' } }, { : 'menu.featured.title', title: 'Nos SpÃ©cialitÃ©s', content: 'DÃ©couvrez nos plats signature', type: 'title', page: 'menu', section: 'featured', is_published: true, metadata: { level: 'h2', style: 'featured' } }, { : 'footer.copyright', title: 'Copyright', content: 'Â© 2024 OMIAM. Tous droits rÃ©servÃ©s.', type: 'text', page: 'global', section: 'footer', is_published: true, metadata: { position: 'bottom' } } ]; console.log('ğŸ“ Tentative d\'insertion des donnÃ©es CMS...'); // Essayer d'insÃ©rer les donnÃ©es (la table doit exister) let successCount = 0; let errorCount = 0; for (const item of Data) { try { const { data, error } = await supabase .from('content_items') .upsert(item, { onConflict: , ignoreDuplicates: false }) .select(); if (error) { console.log(`âš ï¸ Erreur pour ${item.}:`, error.message); errorCount++; } else { console.log(`âœ… DonnÃ©es CMS: ${item.}`); successCount++; } } catch (err) { console.log(`âš ï¸ Exception pour ${item.}:`, err.message); errorCount++; } } console.log(`\nğŸ“Š RÃ©sumÃ©:`); console.log(`âœ… SuccÃ¨s: ${successCount}`); console.log(`âš ï¸ Erreurs: ${errorCount}`); if (successCount > 0) { // VÃ©rifier les donnÃ©es insÃ©rÃ©es console.log('\nğŸ” VÃ©rification des donnÃ©es CMS...'); const { data: items, error: selectError } = await supabase .from('content_items') .select(, title, type, page, is_published') .order('created_at', { ascending: true }); if (selectError) { console.error('âŒ Erreur lors de la vÃ©rification:', selectError.message); } else { console.log(`\nâœ… ${items.length} Ã©lÃ©ments de contenu dans la base:`); // Grouper par page const itemsByPage = items.reduce((acc, item) => { if (!acc[item.page]) acc[item.page] = []; acc[item.page].push(item); return acc; }, {}); Object.entries(itemsByPage).forEach(([page, pageItems]) => { console.log(`\n  ğŸ“„ Page "${page}":`); pageItems.forEach(item => { const status = item.is_published ? 'ğŸŸ¢' : 'ğŸ”´'; console.log(` ${status} ${item.} (${item.type}) - ${item.title}`); }); }); } console.log('\nğŸ‰ Configuration CMS terminÃ©e avec succÃ¨s!'); console.log('\nğŸ’¡ Prochaines Ã©tapes:'); console.log(' 1. VÃ©rifier l\'interface  CMS'); console.log(' 2. er la modification de contenu'); console.log(' 3. VÃ©rifier l\'affichage sur le site'); } else { console.log('\nâŒ Aucune donnÃ©e n\'a pu Ãªtre insÃ©rÃ©e.'); console.log('\nğŸ”§ Actions requises:'); console.log(' 1. VÃ©rifier que la table content_items existe'); console.log(' 2. ExÃ©cuter le script SQL: scripts/create-cms-table.sql'); console.log(' 3. VÃ©rifier les permissions Supabase'); } } catch (error) { console.error('âŒ Erreur gÃ©nÃ©rale:', error.message); console.log('\nğŸ”§ VÃ©rifications suggÃ©rÃ©es:'); console.log(' 1. Connexion Supabase'); console.log(' 2. ClÃ©s d\'API valides'); console.log(' 3. Table content_items crÃ©Ã©e'); }
}

// ExÃ©cuter la configuration
if (require.main === module) { setupCMS();
}

module.exports = { setupCMS };